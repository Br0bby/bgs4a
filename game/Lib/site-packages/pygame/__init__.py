from browser import timer, document, window, ajax
from display import Display
from image import Image



class Pygame(object):
    def __init__(self):
        self.ajax = ajax.ajax()
        self.ajax.bind('complete',self.on_complete)
        self.root = __file__[:__file__.rfind('/')]+'/'
        self.append_script(self.root + "music.js")
        self.append_script(self.root + "image.js")
        self.display = Display()
        self.image = Image()

    def on_complete(self, request):
        if request.status==200 or request.status==0:
            window.eval(request.text)

    def append_script(self, src):
        self.ajax.open('GET', src, False)
        self.ajax.set_header('content-type', 'application/x-www-form-urlencoded')
        self.ajax.send()


    def loop(self, function, FPS=32):
        timer.set_interval(function, 1000 / FPS)


pygame = Pygame()
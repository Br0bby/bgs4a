from browser import document, html, window
from surface import Surface

class Display(object):
    def __init__(self):
        self.canvas = None
        self.screen = None

    def init(self):
        return None

    def quit(self):
        return None

    def get_init(self):
        return True

    def set_mode(self, resolution=(0, 0), flags=0, depth=0, id="pygame"):
        self.canvas = document.getElementById(id)
        self.screen = self.canvas.getContext('2d')
        if not flags:
            self.canvas.width = resolution[0]
            self.canvas.height = resolution[1]
            rx = 1
            ry = 1
        else:
            self.canvas.width = resolution[0]
            self.canvas.height = resolution[1]
            rx = document[html.BODY][0].width / self.canvas.width
            ry = document[html.BODY][0].height / self.canvas.height
            self.canvas.width = document[html.BODY][0].width
            self.canvas.height = document[html.BODY][0].height

        return Surface((self.canvas.width, self.canvas.height),
                       screen=self.screen, ratio_x=rx, ratio_y=ry, canvas=self.canvas)

    def get_surface(self):
        try:
            return Surface((self.canvas.width, self.canvas.height))
        except:
            return False

    def flip(self):
        return None

    def update(self, *args):
        return None

    def get_driver(self):
        return "Brython 2d canvas context"

    def Info(self):
        return None

    def get_wm_info(self):
        return {}

    def list_modes(self):
        return [(640, 480),
                (800, 480),
                (800, 600),
                (1024, 768)]

    def mode_ok(self, size, flags=0, depth=0):
        return 1

    def gl_get_attribute(self, flag):
        return None

    def gl_set_attribute(self, flag, value):
        return None

    def get_active(self):
        return True

    def iconify(self):
        return True

    def toggle_fullscreen(self):
        return False

    def set_gamma(self, red, green=None, blue=None):
        return True

    def set_gamma_ramp(self, red, green, blue):
        return True

    def set_icon(self, Surface=None):
        link = document.createElement("link")
        link.type = "image/x-icon"
        link.rel  = "shortcut icon"
        link.href = Surface
        document.get(selector='head')[0] <= link
        return None

    def set_caption(self, title, icontitle=None):
        document.title = title
        return None

    def get_caption(self):
        return document.title

    def set_palette(self, palette=None):
        return None







